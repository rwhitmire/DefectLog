(function(n){var t=function(n,t,i){"use strict";var r=common.baseUrl+"api/defect",u=$("#defect-form").validate();n.users=common.dataStore.users,n.statuses=common.dataStore.statuses,n.currentUserId=common.dataStore.currentUserId,n.versions=common.dataStore.versions,n.categories=common.dataStore.categories,n.priorityLevels=common.dataStore.priorityLevels,n.defects=[],n.defect=null,n.versionId=common.dataStore.defaultVersion,n.priorityLevelId=common.dataStore.defaultPriorityLevel,n.filterApplied=!1,n.defectClicked=function(t){console.log("loading defect:",t),n.form=angular.copy(t),n.defect=t,n.scrollToForm()},n.formValid=function(){return $("#defect-form").valid()},n.saveDefect=function(){if(!n.formValid())return i.when();var e=n.form.id,o,u=n.form,f={id:u.id,dateLogged:u.dateLogged,developerId:u.developerId,statusId:u.statusId,summary:u.summary,testerId:u.testerId,appVersionId:u.appVersionId,comment:u.comment,userId:n.currentUserId,build:u.build,screen:u.screen,categoryId:u.categoryId,priorityLevelId:u.priorityLevelId};return console.log("saving: ",f),o=e?t.put(r+"/"+e,f):t.post(r,f),o.then(function(){return n.form=null,n.scrollToTop(),n.loadDefects()})},n.newDefect=function(){console.log(n.statuses[0].id),n.form={statusId:n.statuses[0].id,testerId:n.currentUserId,dateLogged:new Date,appVersionId:n.versionId,priorityLevelId:n.priorityLevelId},n.scrollToForm()},n.closeForm=function(){n.form=null,n.scrollToTop()},n.$watch("form",function(){n.resetValidator()}),n.resetValidator=function(){u.resetForm()},n.loadDefects=function(){if(!n.versionId)return i.when();var u=r+"?"+$.param({versionId:n.versionId});return t.get(u).success(function(t){console.log("defects loaded:",t),n.allDefects=t,n.defects=t})},n.developerMeClicked=function(){n.form.developerId=n.currentUserId},n.versionChanged=function(){n.loadDefects(),n.form=null},n.scrollToForm=function(){$("html, body").animate({scrollTop:$("#scroll-to-form").offset().top-70},100)},n.scrollToTop=function(){$("html, body").animate({scrollTop:0},100)},n.statusFilter={statusId:""},n.filterStatus=function(t){n.statusFilter.statusId=t.id},n.showStatus=function(t){return n.statusFilter.statusId?(n.filterApplied=!0,n.statusFilter.statusId==t.id):!0},n.clearFilter=function(){n.statusFilter.statusId="",n.filterApplied=!1},n.truncate=function(n,t){return n?n.length<=t?n:n.substr(0,t)+"...":""},n.getDefectCount=function(){return n.defects.length},n.getStatusCount=function(t){var i=_(n.defects).filter(function(n){return n.statusId==t});return i.length},n.loadDefects()};n.controller("DefectCtrl",["$scope","$http","$q",t])})(angular.module("defectLog",[]));
//@ sourceMappingURL=app.min.js.map